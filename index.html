<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10.0, user-scalable=yes">
    <title> 基督之家第五家QT讀經靈修</title>
    <style type="text/css">
        .iframe {
            width: 100%;
            height: 100%;
        }
        .dateNav{
            text-align: center;
        }

    </style>
    <script type="text/javascript">

        var daysOffset = 0;

        function prev() {
            daysOffset--;
            go(null, true);
        }

        function next() {
            daysOffset++;
            go(null, true);
        }

        function go(dtStr, removeCurrentDate) {
            if(dtStr){
                document.getElementById("currentDay").innerHTML = dtStr;
                document.getElementById("iframeTag").src = "https://hocdevotion.org/event/" + dtStr;
            }else{
                var currentUrl = window.location.href;
                var current_time = new Date().getTime();
                if(removeCurrentDate && currentUrl.includes("?")){
                    var passedInDT = currentUrl.split('?')[1];
                    var passedInDTParts = passedInDT.split('-');
                    var dt = new Date();
                    dt.setFullYear(passedInDTParts[0]);
                    dt.setMonth(passedInDTParts[1]-1);
                    dt.setDate([passedInDTParts[2]]);
                    current_time = dt.getTime();
                }
                var dayMS = 24 * 60 * 60 * 1000;
                var dt = new Date(current_time + daysOffset * dayMS);

                var yyyy = dt.getFullYear();
                var month = dt.getMonth() + 1;
                var day = dt.getDate();
                var dtStr = yyyy + '-' + month + "-" + day;
                document.getElementById("currentDay").innerHTML = dtStr;
                //document.getElementById("iframeTag").src = "https://hocdevotion.org/event/" + dtStr;
                document.title = "基督之家第五家QT讀經靈修 - " + dtStr;

                if(removeCurrentDate && currentUrl.includes("?")){
                    currentUrl = currentUrl.split("?")[0];
                }
                window.location.href = currentUrl +'?'+dtStr;
            }
        }


        const currentUrl =  window.location.href;
        if(currentUrl.indexOf('?')>0){
            setTimeout(()=>{ go(currentUrl.split('?')[1], false); });
        }else{
            setTimeout(()=>{ go(null, false);});
        }

    </script>
</head>
<body>
<div class="dateNav">
    <button onclick="prev()" class="btn">前一天</button>
    <span id="currentDay"></span>
    <button onclick="next()"  class="btn">后一天</button>

</div>
<iframe class="iframe" id="iframeTag" frameborder="0"/>
</body>
</html>
